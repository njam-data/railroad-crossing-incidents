import{H as e,C as t,S as n,i as o,s as r,I as s,c as a,a as l,d as c,b as i,f as u,F as d,G as f,e as m,t as h,g as p,h as g,k as x,n as y,J as b,K as v,E as w,v as $,r as E,j as k,m as N,o as I,B as C,u as D,w as j,L as T,x as _,z as S,D as V,M as A,l as P,N as M,O as z,P as L,Q as R,R as O,T as B,U as K,V as q}from"../chunks/vendor-2816758f.js";import{r as U,b as H}from"../chunks/paths-7dc55c62.js";function Y(e){const t=["rowid","Latitude","Longitude"],n=["Meets minimum safety guidelines","Total Killed","Total injured","Number of accidents","Street","CityName","CountyName","StateName","Active or Passive?","Distance from highway (feet)","Daily trains","Max train speed","Gates","Lights","Daily traffic","Last time traffic counted","School buses","Bus count","Railroad","CrossingID"],o=["link",...e.columns];return{rows:e.rows.map((e=>o.map(((n,o)=>{if(!t.find((e=>e.includes(n))))return"link"===n?{key:"Map view",value:[e[12],e[11]]}:{key:n,value:e[o-1]}})).filter((e=>!!e)).sort(((e,t)=>n.indexOf(e.key)-n.indexOf(t.key))))),columns:o}}const G={subscribe:t=>(()=>{const t=e("__svelte__");return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:t.navigating.subscribe}},session:t.session}})().page.subscribe(t)},J=async function(e,t){return U.goto(e,t,[])};const F={},Q={},W=t({zoom:7.5,lngLat:["-74.558333","40.16"]}),X=t({zoom:2,lngLat:["-98.5556","39.8097"]});function Z(e){let t,n;return{c(){t=s("svg"),n=s("path"),this.h()},l(e){t=a(e,"svg",{height:!0,width:!0,class:!0,fill:!0,xmlns:!0,"xmlns:xlink":!0,version:!0,x:!0,y:!0,viewBox:!0,"enable-background":!0,"xml:space":!0},1);var o=l(t);n=a(o,"path",{d:!0},1),l(n).forEach(c),o.forEach(c),this.h()},h(){i(n,"d","M50,5C25.147,5,5,25.148,5,50c0,24.852,20.147,45,45,45c24.854,0,45-20.148,45-45C95,25.148,74.854,5,50,5z M74.675,38.917  l-23.75,29.511c-1.109,1.379-2.756,2.252-4.517,2.396c-0.173,0.015-0.347,0.021-0.52,0.021c-1.585,0-3.138-0.589-4.326-1.652  L25.985,55.17c-2.463-2.217-2.661-6.01-0.444-8.473c2.218-2.463,6.012-2.662,8.474-0.444l11.223,10.103l20.088-24.961  c2.078-2.582,5.855-2.989,8.438-0.913C76.344,32.558,76.752,36.335,74.675,38.917z"),i(t,"height","20px"),i(t,"width","20px"),i(t,"class","align-top inline"),i(t,"fill","#4CE600"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),i(t,"version","1.1"),i(t,"x","0px"),i(t,"y","0px"),i(t,"viewBox","0 0 100 100"),i(t,"enable-background","new 0 0 100 100"),i(t,"xml:space","preserve")},m(e,o){u(e,t,o),d(t,n)},p:f,i:f,o:f,d(e){e&&c(t)}}}class ee extends n{constructor(e){super(),o(this,e,null,Z,r,{})}}function te(e){let t,n;return{c(){t=s("svg"),n=s("path"),this.h()},l(e){t=a(e,"svg",{height:!0,width:!0,class:!0,fill:!0,xmlns:!0,"xmlns:xlink":!0,version:!0,x:!0,y:!0,viewBox:!0,"enable-background":!0,"xml:space":!0},1);var o=l(t);n=a(o,"path",{d:!0},1),l(n).forEach(c),o.forEach(c),this.h()},h(){i(n,"d","M50,5C25.147,5,5,25.147,5,50c0,24.854,20.147,45,45,45c24.854,0,45-20.146,45-45C95,25.147,74.854,5,50,5z M49.999,76.75  c-3.342,0-6.061-2.717-6.061-6.057c0-3.346,2.719-6.066,6.061-6.066c3.343,0,6.063,2.723,6.063,6.066  C56.063,74.033,53.342,76.75,49.999,76.75z M66.238,43.808c-1.174,1.827-2.795,4.01-6.028,6.531  c-3.213,2.461-4.185,3.724-4.478,4.259c-0.166,0.299-0.402,0.895-0.59,2.004c-0.065,0.39-0.119,0.812-0.162,1.265l-0.254,2.714  l-9.771,0.023l0.124-3.127c0.017-0.4,0.06-1.185,0.168-1.918c0.324-2.229,1.085-4.209,2.261-5.882  c1.104-1.573,3.247-3.563,6.549-6.079c2.442-1.863,3.396-2.928,3.764-3.492c0.47-0.717,0.697-1.472,0.697-2.305  c0-1.931-0.705-3.46-2.094-4.545c-1.474-1.151-3.518-1.735-6.073-1.735c-2.265,0-4.176,0.599-5.682,1.778  c-1.594,1.239-2.713,2.953-3.245,4.964l-0.66,2.492l-9.563-1.037l0.676-3.238c0.88-4.218,2.865-7.474,5.902-9.677  c3.934-2.855,8.156-4.303,12.552-4.303c4.856,0,8.831,1.249,12.508,3.931c3.399,2.482,5.349,6.492,5.349,11.002  C68.188,39.642,67.55,41.727,66.238,43.808z"),i(t,"height","20px"),i(t,"width","20px"),i(t,"class","align-top inline"),i(t,"fill","#A2A2A2"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),i(t,"version","1.1"),i(t,"x","0px"),i(t,"y","0px"),i(t,"viewBox","0 0 100 100"),i(t,"enable-background","new 0 0 100 100"),i(t,"xml:space","preserve")},m(e,o){u(e,t,o),d(t,n)},p:f,i:f,o:f,d(e){e&&c(t)}}}class ne extends n{constructor(e){super(),o(this,e,null,te,r,{})}}function oe(e){let t,n;return{c(){t=s("svg"),n=s("path"),this.h()},l(e){t=a(e,"svg",{height:!0,width:!0,class:!0,fill:!0,xmlns:!0,"xmlns:xlink":!0,version:!0,x:!0,y:!0,viewBox:!0,"enable-background":!0,"xml:space":!0},1);var o=l(t);n=a(o,"path",{d:!0},1),l(n).forEach(c),o.forEach(c),this.h()},h(){i(n,"d","M50,5C25.147,5,5,25.147,5,50c0,24.852,20.147,45,45,45c24.854,0,45-20.148,45-45C95,25.147,74.854,5,50,5z M70.243,70.24  c-1.173,1.172-2.708,1.758-4.243,1.758s-3.07-0.586-4.242-1.757L50,58.484L38.243,70.242C37.071,71.414,35.536,72,34,72  s-3.071-0.586-4.243-1.757c-2.343-2.345-2.343-6.144,0-8.485L41.515,50L29.757,38.242c-2.343-2.343-2.343-6.142,0-8.485  c2.343-2.343,6.142-2.343,8.485,0L50,41.514l11.756-11.757c2.344-2.343,6.145-2.343,8.485,0c2.344,2.343,2.344,6.142,0.001,8.485  L58.486,49.999l11.756,11.756C72.586,64.1,72.586,67.898,70.243,70.24z"),i(t,"height","20px"),i(t,"width","20px"),i(t,"class","align-top inline"),i(t,"fill","#FF0000"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),i(t,"version","1.1"),i(t,"x","0px"),i(t,"y","0px"),i(t,"viewBox","0 0 100 100"),i(t,"enable-background","new 0 0 100 100"),i(t,"xml:space","preserve")},m(e,o){u(e,t,o),d(t,n)},p:f,i:f,o:f,d(e){e&&c(t)}}}class re extends n{constructor(e){super(),o(this,e,null,oe,r,{})}}function se(e,t,n){const o=e.slice();return o[2]=t[n],o}function ae(e){let t,n;return{c(){t=m("h1"),n=h(e[1]),this.h()},l(o){t=a(o,"H1",{class:!0});var r=l(t);n=p(r,e[1]),r.forEach(c),this.h()},h(){i(t,"class","font-medium mb-2")},m(e,o){u(e,t,o),d(t,n)},p(e,t){2&t&&g(n,e[1])},d(e){e&&c(t)}}}function le(e){let t,n,o,r,s,f,v=e[2].description+"";return{c(){t=m("div"),n=m("span"),o=x(),r=m("span"),s=h(v),f=x(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"SPAN",{class:!0,style:!0}),l(n).forEach(c),o=y(i),r=a(i,"SPAN",{class:!0});var u=l(r);s=p(u,v),u.forEach(c),f=y(i),i.forEach(c),this.h()},h(){i(n,"class","w-4 h-4 inline-block rounded-full align-middle"),b(n,"background-color",e[2].color),i(r,"class","align-middle"),i(t,"class","")},m(e,a){u(e,t,a),d(t,n),d(t,o),d(t,r),d(r,s),d(t,f)},p(e,t){1&t&&b(n,"background-color",e[2].color),1&t&&v!==(v=e[2].description+"")&&g(s,v)},d(e){e&&c(t)}}}function ce(e){let t,n,o=e[1]&&ae(e),r=e[0],s=[];for(let a=0;a<r.length;a+=1)s[a]=le(se(e,r,a));return{c(){t=m("div"),o&&o.c(),n=x();for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);o&&o.l(r),n=y(r);for(let t=0;t<s.length;t+=1)s[t].l(r);r.forEach(c),this.h()},h(){i(t,"class","\n    absolute\n    z-10\n    flex\n    flex-col\n    bg-white\n    px-4\n    py-2\n    max-w-[150px]\n    shadow-sm\n    rounded-md\n    bottom-12\n    left-2\n  ")},m(e,r){u(e,t,r),o&&o.m(t,null),d(t,n);for(let n=0;n<s.length;n+=1)s[n].m(t,null)},p(e,[a]){if(e[1]?o?o.p(e,a):(o=ae(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null),1&a){let n;for(r=e[0],n=0;n<r.length;n+=1){const o=se(e,r,n);s[n]?s[n].p(o,a):(s[n]=le(o),s[n].c(),s[n].m(t,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=r.length}},i:f,o:f,d(e){e&&c(t),o&&o.d(),v(s,e)}}}function ie(e,t,n){let{points:o}=t,{title:r}=t;return e.$$set=e=>{"points"in e&&n(0,o=e.points),"title"in e&&n(1,r=e.title)},[o,r]}class ue extends n{constructor(e){super(),o(this,e,ie,ce,r,{points:0,title:1})}}function de(e,t,n){const o=e.slice();return o[13]=t[n],o}function fe(e){let t;const n=e[8].default,o=V(n,e,e[7],null);return{c(){o&&o.c()},l(e){o&&o.l(e)},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||128&r)&&w(o,n,e,e[7],r,null,null)},i(e){t||($(o,e),t=!0)},o(e){E(o,e),t=!1},d(e){o&&o.d(e)}}}function me(e){let t,n,o,r,s;return{c(){t=m("div"),n=m("h1"),o=h("Click a point to learn "),r=m("br"),s=h("about accidents and other information at that railroad crossing."),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"H1",{class:!0});var u=l(n);o=p(u,"Click a point to learn "),r=a(u,"BR",{}),s=p(u,"about accidents and other information at that railroad crossing."),u.forEach(c),i.forEach(c),this.h()},h(){i(n,"class","block self-center w-[220px] font-medium text-gray-500 text-xl mx-auto align-middle"),i(t,"class","px-4 py-4 sm:px-6 flex items center h-full")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(n,r),d(n,s)},p:f,i:f,o:f,d(e){e&&c(t)}}}function he(e){let t,n,o,r,s,f,b,v,w,k,N,I,j,T,_,S,V,A,P,M,z,L,R,O,B,K,q,U,H,Y,G=e[0].properties.Street+"",J=e[0].properties.CityName+"",F=e[0].properties.CountyName+"",Q=e[0].properties.StateName+"",W=e[0].properties["Number of accidents"]+"",X=e[0].properties["Total Killed"]+"",Z=e[0].properties["Total injured"]+"";const ee=[xe,ge,pe],te=[];function ne(e,t){return"Yes"===e[0].properties["Meets minimum safety guidelines"]?0:"No"===e[0].properties["Meets minimum safety guidelines"]?1:2}j=ne(e),T=te[j]=ee[j](e);let oe=e[3]&&ye(e);return{c(){t=m("div"),n=m("h3"),o=h(G),r=x(),s=m("h3"),f=h(J),b=h(", "),v=h(F),w=h(", "),k=h(Q),N=x(),I=m("p"),T.c(),_=x(),S=m("p"),V=h(W),A=h(" Accidents"),P=x(),M=m("p"),z=h(X),L=h(" Killed"),R=x(),O=m("p"),B=h(Z),K=h(" Injured"),q=x(),U=m("div"),H=m("dl"),oe&&oe.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"H3",{class:!0});var u=l(n);o=p(u,G),u.forEach(c),r=y(i),s=a(i,"H3",{class:!0});var d=l(s);f=p(d,J),b=p(d,", "),v=p(d,F),w=p(d,", "),k=p(d,Q),d.forEach(c),N=y(i),I=a(i,"P",{class:!0});var m=l(I);T.l(m),m.forEach(c),_=y(i),S=a(i,"P",{class:!0});var h=l(S);V=p(h,W),A=p(h," Accidents"),h.forEach(c),P=y(i),M=a(i,"P",{class:!0});var g=l(M);z=p(g,X),L=p(g," Killed"),g.forEach(c),R=y(i),O=a(i,"P",{class:!0});var x=l(O);B=p(x,Z),K=p(x," Injured"),x.forEach(c),i.forEach(c),q=y(e),U=a(e,"DIV",{class:!0});var $=l(U);H=a($,"DL",{class:!0});var E=l(H);oe&&oe.l(E),E.forEach(c),$.forEach(c),this.h()},h(){i(n,"class","text-lg leading-6 font-medium text-gray-900"),i(s,"class","text-md leading-6 font-medium text-gray-600 mb-2"),i(I,"class","font-bold my-0 pt-1 pb-3 max-w-2xl text-sm text-gray-600"),i(S,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(M,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(O,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(t,"class","px-4 py-4 sm:px-6"),i(H,"class","divide-y divide-gray-200"),i(U,"class","border-t border-gray-200 px-4 py-2 sm:py-4 sm:p-0")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(t,r),d(t,s),d(s,f),d(s,b),d(s,v),d(s,w),d(s,k),d(t,N),d(t,I),te[j].m(I,null),d(t,_),d(t,S),d(S,V),d(S,A),d(t,P),d(t,M),d(M,z),d(M,L),d(t,R),d(t,O),d(O,B),d(O,K),u(e,q,a),u(e,U,a),d(U,H),oe&&oe.m(H,null),Y=!0},p(e,t){(!Y||1&t)&&G!==(G=e[0].properties.Street+"")&&g(o,G),(!Y||1&t)&&J!==(J=e[0].properties.CityName+"")&&g(f,J),(!Y||1&t)&&F!==(F=e[0].properties.CountyName+"")&&g(v,F),(!Y||1&t)&&Q!==(Q=e[0].properties.StateName+"")&&g(k,Q);let n=j;j=ne(e),j!==n&&(C(),E(te[n],1,1,(()=>{te[n]=null})),D(),T=te[j],T||(T=te[j]=ee[j](e),T.c()),$(T,1),T.m(I,null)),(!Y||1&t)&&W!==(W=e[0].properties["Number of accidents"]+"")&&g(V,W),(!Y||1&t)&&X!==(X=e[0].properties["Total Killed"]+"")&&g(z,X),(!Y||1&t)&&Z!==(Z=e[0].properties["Total injured"]+"")&&g(B,Z),e[3]?oe?oe.p(e,t):(oe=ye(e),oe.c(),oe.m(H,null)):oe&&(oe.d(1),oe=null)},i(e){Y||($(T),Y=!0)},o(e){E(T),Y=!1},d(e){e&&c(t),te[j].d(),e&&c(q),e&&c(U),oe&&oe.d()}}}function pe(e){let t,n,o;return t=new ne({}),{c(){k(t.$$.fragment),n=h(" May or may not meet minimum safety guidelines")},l(e){N(t.$$.fragment,e),n=p(e," May or may not meet minimum safety guidelines")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function ge(e){let t,n,o;return t=new re({}),{c(){k(t.$$.fragment),n=h(" Does not meet minimum safety guidelines")},l(e){N(t.$$.fragment,e),n=p(e," Does not meet minimum safety guidelines")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function xe(e){let t,n,o;return t=new ee({}),{c(){k(t.$$.fragment),n=h(" Meets minimum safety guidelines")},l(e){N(t.$$.fragment,e),n=p(e," Meets minimum safety guidelines")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function ye(e){let t,n=e[3],o=[];for(let r=0;r<n.length;r+=1)o[r]=be(de(e,n,r));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=P()},l(e){for(let t=0;t<o.length;t+=1)o[t].l(e);t=P()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);u(e,t,n)},p(e,r){if(40&r){let s;for(n=e[3],s=0;s<n.length;s+=1){const a=de(e,n,s);o[s]?o[s].p(a,r):(o[s]=be(a),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){v(o,e),e&&c(t)}}}function be(e){let t,n,o,r,s,f,b,v=(e[5][e[13].key]||e[13].key)+"",w=e[13].value+"";return{c(){t=m("div"),n=m("dt"),o=h(v),r=x(),s=m("dd"),f=h(w),b=x(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"DT",{class:!0});var u=l(n);o=p(u,v),u.forEach(c),r=y(i),s=a(i,"DD",{class:!0});var d=l(s);f=p(d,w),d.forEach(c),b=y(i),i.forEach(c),this.h()},h(){i(n,"class","text-sm font-medium text-gray-500"),i(s,"class","text-sm text-gray-900 mt-0 col-span-1"),i(t,"class","py-1 sm:py-2 grid grid-cols-2 gap-2 sm:px-6")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(t,r),d(t,s),d(s,f),d(t,b)},p(e,t){8&t&&v!==(v=(e[5][e[13].key]||e[13].key)+"")&&g(o,v),8&t&&w!==(w=e[13].value+"")&&g(f,w)},d(e){e&&c(t)}}}function ve(e){let t,n,o,r,s,f,h,p,g,b,v=e[2]&&fe(e);r=new ue({props:{points:e[4]}});const w=[he,me],T=[];function _(e,t){return e[0]?0:1}return p=_(e),g=T[p]=w[p](e),{c(){t=m("div"),n=m("div"),v&&v.c(),o=x(),k(r.$$.fragment),s=x(),f=m("div"),h=m("div"),g.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"DIV",{class:!0});var u=l(n);v&&v.l(u),o=y(u),N(r.$$.fragment,u),u.forEach(c),s=y(i),f=a(i,"DIV",{class:!0});var d=l(f);h=a(d,"DIV",{class:!0});var m=l(h);g.l(m),m.forEach(c),d.forEach(c),i.forEach(c),this.h()},h(){i(n,"class","flex-grow z-0 h-full"),i(h,"class","h-full overflow-y-scroll"),i(f,"class","bg-white h-1/2 sm:w-1/2 sm:h-full md:w-96 border-gray-200 border-t sm:border-t-0 sm:border-l"),i(t,"class","flex flex-col sm:flex-row h-full")},m(a,l){u(a,t,l),d(t,n),v&&v.m(n,null),d(n,o),I(r,n,null),e[9](n),d(t,s),d(t,f),d(f,h),T[p].m(h,null),b=!0},p(e,[t]){e[2]?v?(v.p(e,t),4&t&&$(v,1)):(v=fe(e),v.c(),$(v,1),v.m(n,o)):v&&(C(),E(v,1,1,(()=>{v=null})),D());let r=p;p=_(e),p===r?T[p].p(e,t):(C(),E(T[r],1,1,(()=>{T[r]=null})),D(),g=T[p],g?g.p(e,t):(g=T[p]=w[p](e),g.c()),$(g,1),g.m(h,null))},i(e){b||($(v),$(r.$$.fragment,e),$(g),b=!0)},o(e){E(v),E(r.$$.fragment,e),E(g),b=!1},d(n){n&&c(t),v&&v.d(),j(r),e[9](null),T[p].d()}}}function we(e,t,n){let o;T(e,W,(e=>n(11,o=e)));let r,s,a,l,{$$slots:c={},$$scope:i}=t,{center:u}=t,d=null;const f=["id","CrossingID","Total Killed","Total injured","Number of accidents","Latitude","Longitude","Street","CityName","CountyName","StateName","Meets minimum safety guidelines"];return _(F,{getMap:()=>s}),_(Q,{getMapbox:()=>a}),S((async()=>{a=window.mapboxgl,a.accessToken="pk.eyJ1Ijoic2xkYXRhdGVhbSIsImEiOiJja240emRudmgxdzl4MnVuenp0azNmenE4In0.b5791YyrQaKdVufRXj2lqQ",n(2,s=new a.Map({container:r,style:"mapbox://styles/mapbox/light-v10",center:u||o.lngLat,zoom:u?15:o.zoom,minZoom:3,maxZoom:20})),s.addControl(new MapboxGeocoder({accessToken:a.accessToken,mapboxgl:a}),"top-right"),s.on("load",(()=>{s.resize(),s.addSource("railroad_crossing_incidents",{type:"vector",tiles:["https://njam-tiles.s3.amazonaws.com/railroad-crossing-incidents/{z}/{x}/{y}.pbf"]}),s.addLayer({id:"railroad_crossing_incidents",type:"circle",source:"railroad_crossing_incidents","source-layer":"railroad_crossing_incidents",layout:{},paint:{"circle-radius":["case",["has","sqrt_point_count"],["+",["*",["get","sqrt_point_count"],1.1],10],10],"circle-color":["case",["==",["get","Number of accidents"],0],"blue","red"],"circle-opacity":["case",["boolean",["feature-state","hover"],!1],1,.3],"circle-stroke-color":"white","circle-stroke-width":["case",["boolean",["feature-state","hover"],!1],3,0]}})})),u&&setTimeout((()=>{const e=s.project(u),t=s.queryRenderedFeatures([[e.x-5,e.y-5],[e.x+5,e.y+5]],{layers:["railroad_crossing_incidents"]});1===t.length&&n(0,d=t[0])}),1100);let e=null;function t({featureId:e,state:t}){s.setFeatureState({id:e,source:"railroad_crossing_incidents",sourceLayer:"railroad_crossing_incidents"},{hover:t})}let l=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});return s.on("mousemove",(n=>{const o=s.queryRenderedFeatures(n.point,{layers:["railroad_crossing_incidents"]})[0];if(!o)return s.getCanvas().style.cursor="",l.remove(),void(e&&(t({featureId:e,state:!1}),e=null));if(s.getCanvas().style.cursor="pointer",o&&o.id===e)return;e&&t({featureId:e,state:!1}),e=o.id,t({featureId:o.id,state:!0});const r=o.properties,a=o.geometry.coordinates.slice();for(e=o.id;Math.abs(n.lngLat.lng-a[0])>180;)a[0]+=n.lngLat.lng>a[0]?360:-360;if(r.point_count&&r.point_count>-2){const e=`${r.point_count} locations`;l.setLngLat(a).setHTML(e).addTo(s)}})),s.on("click","railroad_crossing_incidents",(async function(e){const t=e.features[0],{point_count:o}=t.properties;if(s.resize(),o){const e=s.getZoom()+2;s.flyTo({center:t.geometry.coordinates,zoom:e}),n(0,d=null)}else n(0,d=e.features[0])})),()=>{n(2,s=null)}})),e.$$set=e=>{"center"in e&&n(6,u=e.center),"$$scope"in e&&n(7,i=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&d&&n(3,l=Object.keys(d.properties).filter((e=>!f.find((t=>t.includes(e))))).map((e=>({key:e,value:d.properties[e]}))))},[d,r,s,l,[{color:"red",description:"Accidents"},{color:"blue",description:"No accidents"}],{CountyName:"County",CityName:"City",StateName:"State"},u,i,c,function(e){A[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class $e extends n{constructor(e){super(),o(this,e,we,ve,r,{center:6})}}const Ee={Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE","District of Columbia":"DC",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",Montana:"MT",Nebraska:"NE",Nevada:"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND",Ohio:"OH",Oklahoma:"OK",Oregon:"OR",Pennsylvania:"PA","Puerto Rico":"PR","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD",Tennessee:"TN",Texas:"TX",Utah:"UT",Vermont:"VT",Virginia:"VA",Washington:"WA","West Virginia":"WV",Wisconsin:"WI",Wyoming:"WY"};function ke(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",{detail:{event:t,node:e}}))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Ne(e,t,n){const o=e.slice();return o[23]=t[n],o}function Ie(e,t,n){const o=e.slice();return o[26]=t[n],o}function Ce(e,t,n){const o=e.slice();return o[29]=t[n],o}function De(e){let t,n,o,r,s,f,g,b,v,w,$,E,k,N,I,C,D=e[5].column===e[29]&&"ASC"===e[5].order&&je();function j(){return e[16](e[29])}let T=e[5].column===e[29]&&"DESC"===e[5].order&&Te();function _(){return e[17](e[29])}function S(){return e[18](e[29])}function V(...t){return e[19](e[29],...t)}return{c(){t=m("div"),n=m("div"),o=m("button"),r=m("span"),D&&D.c(),s=h("\n                            Sort Ascending"),f=x(),g=m("button"),b=m("span"),T&&T.c(),v=h("\n                            Sort Descending"),w=x(),$=m("button"),E=m("span"),k=h("ð„‚"),N=h("\n                            Remove Sort"),this.h()},l(e){t=a(e,"DIV",{class:!0,role:!0,"aria-orientation":!0,"aria-labelledby":!0,tabindex:!0});var i=l(t);n=a(i,"DIV",{class:!0,role:!0});var u=l(n);o=a(u,"BUTTON",{type:!0,class:!0,role:!0,tabindex:!0,id:!0});var d=l(o);r=a(d,"SPAN",{class:!0});var m=l(r);D&&D.l(m),m.forEach(c),s=p(d,"\n                            Sort Ascending"),d.forEach(c),f=y(u),g=a(u,"BUTTON",{type:!0,class:!0,role:!0,tabindex:!0,id:!0});var h=l(g);b=a(h,"SPAN",{class:!0});var x=l(b);T&&T.l(x),x.forEach(c),v=p(h,"\n                            Sort Descending"),h.forEach(c),w=y(u),$=a(u,"BUTTON",{type:!0,class:!0,role:!0,tabindex:!0,id:!0});var I=l($);E=a(I,"SPAN",{class:!0});var C=l(E);k=p(C,"ð„‚"),C.forEach(c),N=p(I,"\n                            Remove Sort"),I.forEach(c),u.forEach(c),i.forEach(c),this.h()},h(){i(r,"class","inline-block w-3 h-3"),i(o,"type","button"),i(o,"class","text-gray-700 hover:text-gray-900 hover:bg-gray-100 block px-2 py-2 text-xs"),i(o,"role","menuitem"),i(o,"tabindex","-1"),i(o,"id","menu-item-0"),i(b,"class","inline-block w-3 h-3"),i(g,"type","button"),i(g,"class","text-gray-700 hover:text-gray-900 hover:bg-gray-100 block px-2 py-2 text-xs"),i(g,"role","menuitem"),i(g,"tabindex","-1"),i(g,"id","menu-item-1"),i(E,"class","inline-block w-3 h-3"),i($,"type","button"),i($,"class","text-gray-700 hover:text-gray-900 hover:bg-gray-100 block px-2 py-2 text-xs"),i($,"role","menuitem"),i($,"tabindex","-1"),i($,"id","menu-item-2"),i(n,"class",""),i(n,"role","none"),i(t,"class","origin-top-right absolute right-0 mt-2 w-40 rounded-md shadow bg-white ring-1 ring-black ring-opacity-5 focus:outline-none"),i(t,"role","menu"),i(t,"aria-orientation","vertical"),i(t,"aria-labelledby","menu-button"),i(t,"tabindex","-1")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(o,r),D&&D.m(r,null),d(o,s),d(n,f),d(n,g),d(g,b),T&&T.m(b,null),d(g,v),d(n,w),d(n,$),d($,E),d(E,k),d($,N),I||(C=[M(o,"click",j),M(g,"click",_),M($,"click",S),L(ke.call(null,t)),M(t,"click_outside",V)],I=!0)},p(t,n){(e=t)[5].column===e[29]&&"ASC"===e[5].order?D||(D=je(),D.c(),D.m(r,null)):D&&(D.d(1),D=null),e[5].column===e[29]&&"DESC"===e[5].order?T||(T=Te(),T.c(),T.m(b,null)):T&&(T.d(1),T=null)},d(e){e&&c(t),D&&D.d(),T&&T.d(),I=!1,R(C)}}}function je(e){let t;return{c(){t=h("âœ“")},l(e){t=p(e,"âœ“")},m(e,n){u(e,t,n)},d(e){e&&c(t)}}}function Te(e){let t;return{c(){t=h("âœ“")},l(e){t=p(e,"âœ“")},m(e,n){u(e,t,n)},d(e){e&&c(t)}}}function _e(e){let t,n,o,r,f,g,b=e[29]+"",v="Map view"!==e[29]&&function(e){let t,n,o,r,f,h,p,g;function b(){return e[15](e[29])}let v=e[6].open&&e[6].open===e[29]&&De(e);return{c(){t=m("div"),n=m("div"),o=m("button"),r=s("svg"),f=s("path"),h=x(),v&&v.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=l(t);n=a(s,"DIV",{});var i=l(n);o=a(i,"BUTTON",{type:!0,class:!0,id:!0,"aria-expanded":!0,"aria-haspopup":!0});var u=l(o);r=a(u,"svg",{class:!0,xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0},1);var d=l(r);f=a(d,"path",{"fill-rule":!0,d:!0,"clip-rule":!0},1),l(f).forEach(c),d.forEach(c),u.forEach(c),i.forEach(c),h=y(s),v&&v.l(s),s.forEach(c),this.h()},h(){i(f,"fill-rule","evenodd"),i(f,"d","M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"),i(f,"clip-rule","evenodd"),i(r,"class","h-3 w-3"),i(r,"xmlns","http://www.w3.org/2000/svg"),i(r,"viewBox","0 0 20 20"),i(r,"fill","currentColor"),i(r,"aria-hidden","true"),i(o,"type","button"),i(o,"class","inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm p-1 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500"),i(o,"id","menu-button"),i(o,"aria-expanded","true"),i(o,"aria-haspopup","true"),i(t,"class","relative inline-block text-left right-0 top-0 ml-4 self-center")},m(e,s){u(e,t,s),d(t,n),d(n,o),d(o,r),d(r,f),d(t,h),v&&v.m(t,null),p||(g=M(o,"click",b),p=!0)},p(n,o){(e=n)[6].open&&e[6].open===e[29]?v?v.p(e,o):(v=De(e),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},d(e){e&&c(t),v&&v.d(),p=!1,g()}}}(e);return{c(){t=m("th"),n=m("div"),o=m("span"),r=h(b),f=x(),v&&v.c(),g=x(),this.h()},l(e){t=a(e,"TH",{scope:!0,class:!0});var s=l(t);n=a(s,"DIV",{class:!0});var i=l(n);o=a(i,"SPAN",{});var u=l(o);r=p(u,b),u.forEach(c),f=y(i),v&&v.l(i),i.forEach(c),g=y(s),s.forEach(c),this.h()},h(){i(n,"class","flex flex-row "),i(t,"scope","col"),i(t,"class","px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider")},m(e,s){u(e,t,s),d(t,n),d(n,o),d(o,r),d(n,f),v&&v.m(n,null),d(t,g)},p(e,t){"Map view"!==e[29]&&v.p(e,t)},d(e){e&&c(t),v&&v.d()}}}function Se(e){let t,n=e[26].value+"";return{c(){t=h(n)},l(e){t=p(e,n)},m(e,n){u(e,t,n)},p(e,o){1&o[0]&&n!==(n=e[26].value+"")&&g(t,n)},i:f,o:f,d(e){e&&c(t)}}}function Ve(e){let t,n,o,r;const s=[ze,Me,Pe],a=[];function l(e,t){return"Yes"===e[26].value?0:"No"===e[26].value?1:2}return t=l(e),n=a[t]=s[t](e),{c(){n.c(),o=P()},l(e){n.l(e),o=P()},m(e,n){a[t].m(e,n),u(e,o,n),r=!0},p(e,r){let c=t;t=l(e),t!==c&&(C(),E(a[c],1,1,(()=>{a[c]=null})),D(),n=a[t],n||(n=a[t]=s[t](e),n.c()),$(n,1),n.m(o.parentNode,o))},i(e){r||($(n),r=!0)},o(e){E(n),r=!1},d(e){a[t].d(e),e&&c(o)}}}function Ae(e){let t,n,o,r;function s(){return e[20](e[26])}return{c(){t=m("button"),n=h("View on map"),this.h()},l(e){t=a(e,"BUTTON",{class:!0});var o=l(t);n=p(o,"View on map"),o.forEach(c),this.h()},h(){i(t,"class","text-gray-600 hover:text-blue-600 hover:shadow-sm bg-gray-50 hover:bg-gray-100 p-2")},m(e,a){u(e,t,a),d(t,n),o||(r=M(t,"click",s),o=!0)},p(t,n){e=t},i:f,o:f,d(e){e&&c(t),o=!1,r()}}}function Pe(e){let t,n,o;return t=new ne({}),{c(){k(t.$$.fragment),n=h(" Info unavailable")},l(e){N(t.$$.fragment,e),n=p(e," Info unavailable")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function Me(e){let t,n,o;return t=new re({}),{c(){k(t.$$.fragment),n=h(" No")},l(e){N(t.$$.fragment,e),n=p(e," No")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function ze(e){let t,n,o;return t=new ee({}),{c(){k(t.$$.fragment),n=h(" Yes")},l(e){N(t.$$.fragment,e),n=p(e," Yes")},m(e,r){I(t,e,r),u(e,n,r),o=!0},i(e){o||($(t.$$.fragment,e),o=!0)},o(e){E(t.$$.fragment,e),o=!1},d(e){j(t,e),e&&c(n)}}}function Le(e){let t,n,o,r;const s=[Ae,Ve,Se],d=[];function f(e,t){return"Map view"===e[26].key?0:"Meets minimum safety guidelines"===e[26].key?1:2}return n=f(e),o=d[n]=s[n](e),{c(){t=m("td"),o.c(),this.h()},l(e){t=a(e,"TD",{class:!0});var n=l(t);o.l(n),n.forEach(c),this.h()},h(){i(t,"class","px-12 py-4 text-left whitespace-nowrap text-sm font-medium text-gray-900")},m(e,o){u(e,t,o),d[n].m(t,null),r=!0},p(e,r){let a=n;n=f(e),n===a?d[n].p(e,r):(C(),E(d[a],1,1,(()=>{d[a]=null})),D(),o=d[n],o?o.p(e,r):(o=d[n]=s[n](e),o.c()),$(o,1),o.m(t,null))},i(e){r||($(o),r=!0)},o(e){E(o),r=!1},d(e){e&&c(t),d[n].d()}}}function Re(e){let t,n,o,r=e[23],s=[];for(let a=0;a<r.length;a+=1)s[a]=Le(Ie(e,r,a));const i=e=>E(s[e],1,1,(()=>{s[e]=null}));return{c(){t=m("tr");for(let e=0;e<s.length;e+=1)s[e].c();n=x()},l(e){t=a(e,"TR",{});var o=l(t);for(let t=0;t<s.length;t+=1)s[t].l(o);n=y(o),o.forEach(c)},m(e,r){u(e,t,r);for(let n=0;n<s.length;n+=1)s[n].m(t,null);d(t,n),o=!0},p(e,o){if(16385&o[0]){let a;for(r=e[23],a=0;a<r.length;a+=1){const l=Ie(e,r,a);s[a]?(s[a].p(l,o),$(s[a],1)):(s[a]=Le(l),s[a].c(),$(s[a],1),s[a].m(t,n))}for(C(),a=r.length;a<s.length;a+=1)i(a);D()}},i(e){if(!o){for(let e=0;e<r.length;e+=1)$(s[e]);o=!0}},o(e){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)E(s[t]);o=!1},d(e){e&&c(t),v(s,e)}}}function Oe(e){let t,n,o,r;function s(e,t){return e[4]>1?Ke:Be}let f=s(e),x=f(e);return{c(){t=m("p"),x.c(),n=h("\n\n    of "),o=h(e[2]),r=h(" total rows."),this.h()},l(s){t=a(s,"P",{class:!0});var i=l(t);x.l(i),n=p(i,"\n\n    of "),o=p(i,e[2]),r=p(i," total rows."),i.forEach(c),this.h()},h(){i(t,"class","float-left py-1.5 mt-2 text-xs text-gray-700")},m(e,s){u(e,t,s),x.m(t,null),d(t,n),d(t,o),d(t,r)},p(e,r){f===(f=s(e))&&x?x.p(e,r):(x.d(1),x=f(e),x&&(x.c(),x.m(t,n))),4&r[0]&&g(o,e[2])},d(e){e&&c(t),x.d()}}}function Be(e){let t;return{c(){t=h("1 to 100")},l(e){t=p(e,"1 to 100")},m(e,n){u(e,t,n)},p:f,d(e){e&&c(t)}}}function Ke(e){let t,n,o,r=100*e[4]-100+1+"";function s(e,t){return 100*e[4]>e[2]?Ue:qe}let a=s(e),l=a(e);return{c(){t=h(r),n=h("\n      to\n      "),l.c(),o=P()},l(e){t=p(e,r),n=p(e,"\n      to\n      "),l.l(e),o=P()},m(e,r){u(e,t,r),u(e,n,r),l.m(e,r),u(e,o,r)},p(e,n){16&n[0]&&r!==(r=100*e[4]-100+1+"")&&g(t,r),a===(a=s(e))&&l?l.p(e,n):(l.d(1),l=a(e),l&&(l.c(),l.m(o.parentNode,o)))},d(e){e&&c(t),e&&c(n),l.d(e),e&&c(o)}}}function qe(e){let t,n=100*e[4]+"";return{c(){t=h(n)},l(e){t=p(e,n)},m(e,n){u(e,t,n)},p(e,o){16&o[0]&&n!==(n=100*e[4]+"")&&g(t,n)},d(e){e&&c(t)}}}function Ue(e){let t;return{c(){t=h(e[2])},l(n){t=p(n,e[2])},m(e,n){u(e,t,n)},p(e,n){4&n[0]&&g(t,e[2])},d(e){e&&c(t)}}}function He(e){let t,n,o,r;return{c(){t=m("button"),n=h("Next page"),this.h()},l(e){t=a(e,"BUTTON",{class:!0});var o=l(t);n=p(o,"Next page"),o.forEach(c),this.h()},h(){i(t,"class","mt-2 float-right inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500")},m(s,a){u(s,t,a),d(t,n),o||(r=M(t,"click",e[12]),o=!0)},p:f,d(e){e&&c(t),o=!1,r()}}}function Ye(e){let t,n,o,r;return{c(){t=m("button"),n=h("Previous page"),this.h()},l(e){t=a(e,"BUTTON",{class:!0});var o=l(t);n=p(o,"Previous page"),o.forEach(c),this.h()},h(){i(t,"class","mt-2 mr-2 float-right inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500")},m(s,a){u(s,t,a),d(t,n),o||(r=M(t,"click",e[13]),o=!0)},p:f,d(e){e&&c(t),o=!1,r()}}}function Ge(e){let t,n,o,r,s,f,h,p,g,b,w,k,N,I,j,T,_,S,V=e[7],A=[];for(let a=0;a<V.length;a+=1)A[a]=_e(Ce(e,V,a));let P=e[0],M=[];for(let a=0;a<P.length;a+=1)M[a]=Re(Ne(e,P,a));const z=e=>E(M[e],1,1,(()=>{M[e]=null}));let L=e[3]&&Oe(e),R=e[1]&&He(e),O=e[4]>1&&Ye(e);return{c(){t=m("div"),n=m("div"),o=m("div"),r=m("div"),s=x(),f=m("div"),h=m("div"),p=m("div"),g=m("table"),b=m("thead"),w=m("tr");for(let e=0;e<A.length;e+=1)A[e].c();k=x(),N=m("tbody");for(let e=0;e<M.length;e+=1)M[e].c();I=x(),j=m("div"),L&&L.c(),T=x(),R&&R.c(),_=x(),O&&O.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"DIV",{class:!0});var u=l(n);o=a(u,"DIV",{class:!0});var d=l(o);r=a(d,"DIV",{id:!0}),l(r).forEach(c),d.forEach(c),u.forEach(c),s=y(i),f=a(i,"DIV",{class:!0});var m=l(f);h=a(m,"DIV",{class:!0});var x=l(h);p=a(x,"DIV",{class:!0});var v=l(p);g=a(v,"TABLE",{class:!0});var $=l(g);b=a($,"THEAD",{class:!0});var E=l(b);w=a(E,"TR",{class:!0});var C=l(w);for(let t=0;t<A.length;t+=1)A[t].l(C);C.forEach(c),E.forEach(c),k=y($),N=a($,"TBODY",{class:!0});var D=l(N);for(let t=0;t<M.length;t+=1)M[t].l(D);D.forEach(c),$.forEach(c),v.forEach(c),x.forEach(c),m.forEach(c),i.forEach(c),I=y(e),j=a(e,"DIV",{class:!0});var S=l(j);L&&L.l(S),T=y(S),R&&R.l(S),_=y(S),O&&O.l(S),S.forEach(c),this.h()},h(){i(r,"id","geocoder"),i(o,"class",""),i(n,"class","w-full h-96 p-2"),i(w,"class","divide-x divide-gray-200"),i(b,"class","bg-gray-50"),i(N,"class","divide-y divide-gray-200"),i(g,"class","min-w-full divide-y divide-gray-200 bg-white"),i(p,"class","shadow border-b border-t border-gray-200 sm:rounded-md"),i(h,"class","align-middle inline-block min-w-full"),i(f,"class",""),i(t,"class","flex flex-col h-full overflow-scroll bg-gray-50"),i(j,"class","")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(o,r),d(t,s),d(t,f),d(f,h),d(h,p),d(p,g),d(g,b),d(b,w);for(let t=0;t<A.length;t+=1)A[t].m(w,null);d(g,k),d(g,N);for(let t=0;t<M.length;t+=1)M[t].m(N,null);u(e,I,a),u(e,j,a),L&&L.m(j,null),d(j,T),R&&R.m(j,null),d(j,_),O&&O.m(j,null),S=!0},p(e,t){if(4064&t[0]){let n;for(V=e[7],n=0;n<V.length;n+=1){const o=Ce(e,V,n);A[n]?A[n].p(o,t):(A[n]=_e(o),A[n].c(),A[n].m(w,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=V.length}if(16385&t[0]){let n;for(P=e[0],n=0;n<P.length;n+=1){const o=Ne(e,P,n);M[n]?(M[n].p(o,t),$(M[n],1)):(M[n]=Re(o),M[n].c(),$(M[n],1),M[n].m(N,null))}for(C(),n=P.length;n<M.length;n+=1)z(n);D()}e[3]?L?L.p(e,t):(L=Oe(e),L.c(),L.m(j,T)):L&&(L.d(1),L=null),e[1]?R?R.p(e,t):(R=He(e),R.c(),R.m(j,_)):R&&(R.d(1),R=null),e[4]>1?O?O.p(e,t):(O=Ye(e),O.c(),O.m(j,null)):O&&(O.d(1),O=null)},i(e){if(!S){for(let e=0;e<P.length;e+=1)$(M[e]);S=!0}},o(e){M=M.filter(Boolean);for(let t=0;t<M.length;t+=1)E(M[t]);S=!1},d(e){e&&c(t),v(A,e),v(M,e),e&&c(I),e&&c(j),L&&L.d(),R&&R.d(),O&&O.d()}}}function Je(e,t,n){let{rows:o}=t,{next:r}=t,{rowsCount:s}=t,{loaded:a}=t,{currentPage:l}=t,c=[],i={column:null,order:null},u={open:null};const d=o[0].map((e=>e.key)),f=z();function m(e){u.open===e?n(6,u.open=null,u):setTimeout((()=>{n(6,u.open=e,u)}),2)}function h(e,t){console.log("e",t.detail),u.open===e&&setTimeout((()=>{n(6,u.open=null,u)}),1),n(6,u.open=e,u)}function p(e,t){n(5,i={column:e,order:t}),f("query",{sort:i,filters:c})}function g(e){n(5,i={column:null,order:null}),f("query",{sort:i,filters:c})}function x(e){console.log("huh"),f("viewLocation",e)}S((()=>{const e=window.mapboxgl;e.accessToken="pk.eyJ1Ijoic2xkYXRhdGVhbSIsImEiOiJuR1ZmQ01vIn0.zyEdsIKM-4orPm-3Y0XWDQ";const t=new MapboxGeocoder({accessToken:e.accessToken,types:"region,district,place"});t.addTo("#geocoder"),t.on("result",(({result:e})=>{const t=e,{place_name:n,place_type:o}=t,r=n.split(", "),s=o[0];"place"===s?(c.push({column:"CityName",value:r[0]}),c.push({column:"StateName",value:Ee[r[1]]})):"district"===s?(c.push({column:"CountyName",value:r[0].replace(" County","").toLowerCase()}),c.push({column:"StateName",value:Ee[r[1]]})):"region"===s&&c.push({column:"StateName",value:Ee[r[0]]}),f("query",{sort:i,filters:c})}))}));return e.$$set=e=>{"rows"in e&&n(0,o=e.rows),"next"in e&&n(1,r=e.next),"rowsCount"in e&&n(2,s=e.rowsCount),"loaded"in e&&n(3,a=e.loaded),"currentPage"in e&&n(4,l=e.currentPage)},e.$$.update=()=>{32&e.$$.dirty[0]&&console.log("sort",i)},[o,r,s,a,l,i,u,d,m,h,p,g,function(e){f("nextPage",{sort:i,filters:c})},function(e){f("previousPage",{sort:i,filters:c})},x,e=>{m(e)},e=>p(e,"ASC"),e=>p(e,"DESC"),e=>g(),(e,t)=>{h(e,t)},e=>{x(e.value)}]}class Fe extends n{constructor(e){super(),o(this,e,Je,Ge,r,{rows:0,next:1,rowsCount:2,loaded:3,currentPage:4},[-1,-1])}}function Qe(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function We(e){let t,n;return{c(){t=m("h1"),n=h(e[1]),this.h()},l(o){t=a(o,"H1",{class:!0});var r=l(t);n=p(r,e[1]),r.forEach(c),this.h()},h(){i(t,"class","font-medium mb-2")},m(e,o){u(e,t,o),d(t,n)},p(e,t){2&t&&g(n,e[1])},d(e){e&&c(t)}}}function Xe(e){let t;return{c(){t=h("+")},l(e){t=p(e,"+")},m(e,n){u(e,t,n)},p:f,d(e){e&&c(t)}}}function Ze(e){let t,n,o=e[0][e[4]+1][0]-1+"";return{c(){t=h("-"),n=h(o)},l(e){t=p(e,"-"),n=p(e,o)},m(e,o){u(e,t,o),u(e,n,o)},p(e,t){1&t&&o!==(o=e[0][e[4]+1][0]-1+"")&&g(n,o)},d(e){e&&c(t),e&&c(n)}}}function et(e){let t,n,o,r,s,f,v=e[2][0]+"";function w(e,t){return e[0][e[4]+1]?Ze:Xe}let $=w(e),E=$(e);return{c(){t=m("div"),n=m("span"),o=x(),r=m("span"),s=h(v),E.c(),f=x(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"SPAN",{class:!0,style:!0}),l(n).forEach(c),o=y(i),r=a(i,"SPAN",{});var u=l(r);s=p(u,v),E.l(u),u.forEach(c),f=y(i),i.forEach(c),this.h()},h(){i(n,"class","w-4 h-4 inline-block"),b(n,"background-color",e[2][1]),i(t,"class","")},m(e,a){u(e,t,a),d(t,n),d(t,o),d(t,r),d(r,s),E.m(r,null),d(t,f)},p(e,t){1&t&&b(n,"background-color",e[2][1]),1&t&&v!==(v=e[2][0]+"")&&g(s,v),$===($=w(e))&&E?E.p(e,t):(E.d(1),E=$(e),E&&(E.c(),E.m(r,null)))},d(e){e&&c(t),E.d()}}}function tt(e){let t,n,o=e[1]&&We(e),r=e[0],s=[];for(let a=0;a<r.length;a+=1)s[a]=et(Qe(e,r,a));return{c(){t=m("div"),o&&o.c(),n=x();for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);o&&o.l(r),n=y(r);for(let t=0;t<s.length;t+=1)s[t].l(r);r.forEach(c),this.h()},h(){i(t,"class","\n    absolute\n    z-10\n    flex\n    flex-col\n    bg-white\n    px-4\n    py-2\n    max-w-[150px]\n    shadow-sm\n    rounded-md\n    bottom-12\n    left-2\n  ")},m(e,r){u(e,t,r),o&&o.m(t,null),d(t,n);for(let n=0;n<s.length;n+=1)s[n].m(t,null)},p(e,[a]){if(e[1]?o?o.p(e,a):(o=We(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null),1&a){let n;for(r=e[0],n=0;n<r.length;n+=1){const o=Qe(e,r,n);s[n]?s[n].p(o,a):(s[n]=et(o),s[n].c(),s[n].m(t,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=r.length}},i:f,o:f,d(e){e&&c(t),o&&o.d(),v(s,e)}}}function nt(e,t,n){let{scale:o}=t,{title:r}=t;return e.$$set=e=>{"scale"in e&&n(0,o=e.scale),"title"in e&&n(1,r=e.title)},[o,r]}class ot extends n{constructor(e){super(),o(this,e,nt,tt,r,{scale:0,title:1})}}function rt(e){let t;const n=e[8].default,o=V(n,e,e[7],null);return{c(){o&&o.c()},l(e){o&&o.l(e)},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||128&r)&&w(o,n,e,e[7],r,null,null)},i(e){t||($(o,e),t=!0)},o(e){E(o,e),t=!1},d(e){o&&o.d(e)}}}function st(e){let t,n,o,r,s,f,b,v,w,$,E,k,N,I,C,D,j,T,_,S,V,A,P=e[3].properties.name+"",M=e[3].properties.accidents+"",z=e[3].properties.killed+"",L=e[3].properties.injured+"";return{c(){t=m("div"),n=m("div"),o=m("h3"),r=h(P),s=x(),f=m("p"),b=h(M),v=x(),w=m("span"),$=h("Accidents"),E=x(),k=m("p"),N=h(z),I=x(),C=m("span"),D=h("Killed"),j=x(),T=m("p"),_=h(L),S=x(),V=m("span"),A=h("Injured"),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"DIV",{class:!0});var u=l(n);o=a(u,"H3",{class:!0});var d=l(o);r=p(d,P),d.forEach(c),s=y(u),f=a(u,"P",{class:!0});var m=l(f);b=p(m,M),v=y(m),w=a(m,"SPAN",{class:!0});var h=l(w);$=p(h,"Accidents"),h.forEach(c),m.forEach(c),E=y(u),k=a(u,"P",{class:!0});var g=l(k);N=p(g,z),I=y(g),C=a(g,"SPAN",{class:!0});var x=l(C);D=p(x,"Killed"),x.forEach(c),g.forEach(c),j=y(u),T=a(u,"P",{class:!0});var R=l(T);_=p(R,L),S=y(R),V=a(R,"SPAN",{class:!0});var O=l(V);A=p(O,"Injured"),O.forEach(c),R.forEach(c),u.forEach(c),i.forEach(c),this.h()},h(){i(o,"class","text-2xl leading-6 font-bold text-gray-900 pb-2 mb-2 border-b border-gray-100"),i(w,"class","font-normal"),i(f,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(C,"class","font-normal"),i(k,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(V,"class","font-normal"),i(T,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(n,"class","px-4 py-4 sm:px-6"),i(t,"class","bg-white shadow overflow-hidden rounded-md absolute top-4 right-0 mr-4 w-1/2 lg:w-1/3 pb-2")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(o,r),d(n,s),d(n,f),d(f,b),d(f,v),d(f,w),d(w,$),d(n,E),d(n,k),d(k,N),d(k,I),d(k,C),d(C,D),d(n,j),d(n,T),d(T,_),d(T,S),d(T,V),d(V,A)},p(e,t){8&t&&P!==(P=e[3].properties.name+"")&&g(r,P),8&t&&M!==(M=e[3].properties.accidents+"")&&g(b,M),8&t&&z!==(z=e[3].properties.killed+"")&&g(N,z),8&t&&L!==(L=e[3].properties.injured+"")&&g(_,L)},d(e){e&&c(t)}}}function at(e){let t,n,o,r,s,f,g,b,v,w,T,_,S,V,A,P,z,L=e[2]&&rt(e);S=new ot({props:{scale:e[5],title:e[4]}});let B=e[3]&&st(e);return{c(){t=m("div"),L&&L.c(),n=x(),o=m("div"),r=m("button"),s=h("Accidents"),f=x(),g=m("button"),b=h("Killed"),v=x(),w=m("button"),T=h("Injured"),_=x(),k(S.$$.fragment),V=x(),B&&B.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);L&&L.l(i),n=y(i),o=a(i,"DIV",{class:!0});var u=l(o);r=a(u,"BUTTON",{type:!0,class:!0});var d=l(r);s=p(d,"Accidents"),d.forEach(c),f=y(u),g=a(u,"BUTTON",{type:!0,class:!0});var m=l(g);b=p(m,"Killed"),m.forEach(c),v=y(u),w=a(u,"BUTTON",{type:!0,class:!0});var h=l(w);T=p(h,"Injured"),h.forEach(c),u.forEach(c),_=y(i),N(S.$$.fragment,i),V=y(i),B&&B.l(i),i.forEach(c),this.h()},h(){i(r,"type","button"),i(r,"class","\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        rounded-t-md\n        sm:rounded-l-md\n        sm:rounded-tr-none\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(r,"selected","accidents"===e[0]),i(g,"type","button"),i(g,"class","\n        sm:-ml-px\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(g,"selected","killed"===e[0]),i(w,"type","button"),i(w,"class","\n        sm:-ml-px\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        rounded-b-md\n        sm:rounded-r-md\n        sm:rounded-bl-none\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(w,"selected","injured"===e[0]),i(o,"class","absolute z-10 flex flex-col sm:flex-row shadow-sm rounded-md top-2 left-2"),i(t,"class","flex-grow z-0 h-full")},m(a,l){u(a,t,l),L&&L.m(t,null),d(t,n),d(t,o),d(o,r),d(r,s),d(o,f),d(o,g),d(g,b),d(o,v),d(o,w),d(w,T),d(t,_),I(S,t,null),d(t,V),B&&B.m(t,null),e[12](t),A=!0,P||(z=[M(r,"click",e[9]),M(g,"click",e[10]),M(w,"click",e[11])],P=!0)},p(e,[o]){e[2]?L?(L.p(e,o),4&o&&$(L,1)):(L=rt(e),L.c(),$(L,1),L.m(t,n)):L&&(C(),E(L,1,1,(()=>{L=null})),D()),1&o&&O(r,"selected","accidents"===e[0]),1&o&&O(g,"selected","killed"===e[0]),1&o&&O(w,"selected","injured"===e[0]);const s={};32&o&&(s.scale=e[5]),16&o&&(s.title=e[4]),S.$set(s),e[3]?B?B.p(e,o):(B=st(e),B.c(),B.m(t,null)):B&&(B.d(1),B=null)},i(e){A||($(L),$(S.$$.fragment,e),A=!0)},o(e){E(L),E(S.$$.fragment,e),A=!1},d(n){n&&c(t),L&&L.d(),j(S),B&&B.d(),e[12](null),P=!1,R(z)}}}function lt(e,t,n){let o,r,s;T(e,X,(e=>n(14,s=e)));let a,l,c,{$$slots:i={},$$scope:u}=t,d="accidents",f=null;const m={accidents:"Number of accidents",injured:"Number of accidents with injuries",killed:"Number of accidents with fatalities"},h={accidents:[[0,"#fcde9c"],[500,"#faa476"],[1e3,"#f0746e"],[2e3,"#e34f6f"],[4e3,"#dc3977"],[8e3,"#b9257a"],[16e3,"#7c1d6f"]],injured:[[0,"#fcde9c"],[250,"#faa476"],[500,"#f0746e"],[750,"#e34f6f"],[1e3,"#dc3977"],[1250,"#b9257a"],[1500,"#7c1d6f"]],killed:[[0,"#fcde9c"],[825,"#faa476"],[1750,"#f0746e"],[2625,"#e34f6f"],[3500,"#dc3977"],[4375,"#b9257a"],[6175,"#7c1d6f"]]};function p(e){console.log("prop",e),n(0,d=e);const t=r;l.setPaintProperty("state_totals","fill-color",{property:d,stops:t})}_(F,{getMap:()=>l}),_(Q,{getMapbox:()=>c}),S((async()=>(c=window.mapboxgl,c.accessToken="pk.eyJ1Ijoic2xkYXRhdGVhbSIsImEiOiJja240emRudmgxdzl4MnVuenp0azNmenE4In0.b5791YyrQaKdVufRXj2lqQ",n(2,l=new c.Map({container:a,style:"mapbox://styles/mapbox/light-v10",center:s.lngLat,zoom:s.zoom,minZoom:0,maxZoom:8})),l.on("load",(()=>{l.resize(),l.addSource("state_totals",{type:"vector",tiles:["https://njam-tiles.s3.amazonaws.com/railroad-crossing-incident-totals/states/{z}/{x}/{y}.pbf"]}),l.addLayer({id:"state_totals",type:"fill",source:"state_totals","source-layer":"state_totals",layout:{},paint:{"fill-color":{property:d,stops:[[0,"#fcde9c"],[500,"#faa476"],[1e3,"#f0746e"],[2e3,"#e34f6f"],[4e3,"#dc3977"],[8e3,"#b9257a"],[16e3,"#7c1d6f"]]},"fill-opacity":["case",["boolean",["feature-state","hover"],!1],1,.8]}}),l.addLayer({id:"state_totals_lines",type:"line",source:"state_totals","source-layer":"state_totals",layout:{},paint:{"line-color":"#444","line-width":2}})})),l.on("mouseenter","state_totals",(function(e){l.getCanvas().style.cursor="pointer"})),l.on("mouseleave","state_totals",(function(){l.getCanvas().style.cursor=""})),l.on("click",(async function(e){const t=l.queryRenderedFeatures(e.point);n(3,f=t.find((e=>"state_totals"===e.layer.id)))})),()=>{n(2,l=null)})));return e.$$set=e=>{"$$scope"in e&&n(7,u=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&n(4,o=m[d]),1&e.$$.dirty&&n(5,r=h[d])},[d,a,l,f,o,r,p,u,i,()=>{p("accidents")},()=>{p("killed")},()=>{p("injured")},function(e){A[e?"unshift":"push"]((()=>{a=e,n(1,a)}))}]}class ct extends n{constructor(e){super(),o(this,e,lt,at,r,{})}}function it(e){let t;const n=e[8].default,o=V(n,e,e[7],null);return{c(){o&&o.c()},l(e){o&&o.l(e)},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||128&r)&&w(o,n,e,e[7],r,null,null)},i(e){t||($(o,e),t=!0)},o(e){E(o,e),t=!1},d(e){o&&o.d(e)}}}function ut(e){let t,n,o,r,s,f,b,v,w,$,E,k,N,I,C,D,j,T,_,S,V,A,P=e[3].properties.name+"",M=e[3].properties.accidents+"",z=e[3].properties.killed+"",L=e[3].properties.injured+"";return{c(){t=m("div"),n=m("div"),o=m("h3"),r=h(P),s=x(),f=m("p"),b=h(M),v=x(),w=m("span"),$=h("Accidents"),E=x(),k=m("p"),N=h(z),I=x(),C=m("span"),D=h("Killed"),j=x(),T=m("p"),_=h(L),S=x(),V=m("span"),A=h("Injured"),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);n=a(i,"DIV",{class:!0});var u=l(n);o=a(u,"H3",{class:!0});var d=l(o);r=p(d,P),d.forEach(c),s=y(u),f=a(u,"P",{class:!0});var m=l(f);b=p(m,M),v=y(m),w=a(m,"SPAN",{class:!0});var h=l(w);$=p(h,"Accidents"),h.forEach(c),m.forEach(c),E=y(u),k=a(u,"P",{class:!0});var g=l(k);N=p(g,z),I=y(g),C=a(g,"SPAN",{class:!0});var x=l(C);D=p(x,"Killed"),x.forEach(c),g.forEach(c),j=y(u),T=a(u,"P",{class:!0});var R=l(T);_=p(R,L),S=y(R),V=a(R,"SPAN",{class:!0});var O=l(V);A=p(O,"Injured"),O.forEach(c),R.forEach(c),u.forEach(c),i.forEach(c),this.h()},h(){i(o,"class","text-2xl leading-6 font-bold text-gray-900 pb-2 mb-2 border-b border-gray-100"),i(w,"class","font-normal"),i(f,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(C,"class","font-normal"),i(k,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(V,"class","font-normal"),i(T,"class","font-bold my-0 py0 max-w-2xl text-lg text-gray-600"),i(n,"class","px-4 py-4 sm:px-6"),i(t,"class","bg-white shadow overflow-hidden rounded-md absolute top-4 right-0 mr-4 w-1/2 lg:w-1/3 pb-2")},m(e,a){u(e,t,a),d(t,n),d(n,o),d(o,r),d(n,s),d(n,f),d(f,b),d(f,v),d(f,w),d(w,$),d(n,E),d(n,k),d(k,N),d(k,I),d(k,C),d(C,D),d(n,j),d(n,T),d(T,_),d(T,S),d(T,V),d(V,A)},p(e,t){8&t&&P!==(P=e[3].properties.name+"")&&g(r,P),8&t&&M!==(M=e[3].properties.accidents+"")&&g(b,M),8&t&&z!==(z=e[3].properties.killed+"")&&g(N,z),8&t&&L!==(L=e[3].properties.injured+"")&&g(_,L)},d(e){e&&c(t)}}}function dt(e){let t,n,o,r,s,f,g,b,v,w,T,_,S,V,A,P,z,L=e[2]&&it(e);S=new ot({props:{scale:e[5],title:e[4]}});let B=e[3]&&ut(e);return{c(){t=m("div"),L&&L.c(),n=x(),o=m("div"),r=m("button"),s=h("Accidents"),f=x(),g=m("button"),b=h("Killed"),v=x(),w=m("button"),T=h("Injured"),_=x(),k(S.$$.fragment),V=x(),B&&B.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var i=l(t);L&&L.l(i),n=y(i),o=a(i,"DIV",{class:!0});var u=l(o);r=a(u,"BUTTON",{type:!0,class:!0});var d=l(r);s=p(d,"Accidents"),d.forEach(c),f=y(u),g=a(u,"BUTTON",{type:!0,class:!0});var m=l(g);b=p(m,"Killed"),m.forEach(c),v=y(u),w=a(u,"BUTTON",{type:!0,class:!0});var h=l(w);T=p(h,"Injured"),h.forEach(c),u.forEach(c),_=y(i),N(S.$$.fragment,i),V=y(i),B&&B.l(i),i.forEach(c),this.h()},h(){i(r,"type","button"),i(r,"class","\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        rounded-t-md\n        sm:rounded-l-md\n        sm:rounded-tr-none\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(r,"selected","accidents"===e[0]),i(g,"type","button"),i(g,"class","\n        sm:-ml-px\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(g,"selected","killed"===e[0]),i(w,"type","button"),i(w,"class","\n        sm:-ml-px\n        relative\n        inline-flex\n        items-center\n        px-4\n        py-2\n        rounded-b-md\n        sm:rounded-r-md\n        sm:rounded-bl-none\n        border\n        border-gray-300\n        bg-white\n        text-sm\n        font-medium\n        text-gray-700\n        hover:bg-gray-50\n        focus:z-10\n        focus:outline-none\n        focus:ring-1\n        focus:ring-indigo-500\n        focus:border-indigo-500\n      "),O(w,"selected","injured"===e[0]),i(o,"class","absolute z-10 flex flex-col sm:flex-row shadow-sm rounded-md top-2 left-2"),i(t,"class","flex-grow z-0 h-full")},m(a,l){u(a,t,l),L&&L.m(t,null),d(t,n),d(t,o),d(o,r),d(r,s),d(o,f),d(o,g),d(g,b),d(o,v),d(o,w),d(w,T),d(t,_),I(S,t,null),d(t,V),B&&B.m(t,null),e[12](t),A=!0,P||(z=[M(r,"click",e[9]),M(g,"click",e[10]),M(w,"click",e[11])],P=!0)},p(e,[o]){e[2]?L?(L.p(e,o),4&o&&$(L,1)):(L=it(e),L.c(),$(L,1),L.m(t,n)):L&&(C(),E(L,1,1,(()=>{L=null})),D()),1&o&&O(r,"selected","accidents"===e[0]),1&o&&O(g,"selected","killed"===e[0]),1&o&&O(w,"selected","injured"===e[0]);const s={};16&o&&(s.title=e[4]),S.$set(s),e[3]?B?B.p(e,o):(B=ut(e),B.c(),B.m(t,null)):B&&(B.d(1),B=null)},i(e){A||($(L),$(S.$$.fragment,e),A=!0)},o(e){E(L),E(S.$$.fragment,e),A=!1},d(n){n&&c(t),L&&L.d(),j(S),B&&B.d(),e[12](null),P=!1,R(z)}}}function ft(e,t,n){let o,r;T(e,W,(e=>n(14,r=e)));let s,a,l,{$$slots:c={},$$scope:i}=t,u="accidents",d=null;const f={accidents:"Number of accidents",injured:"Number of accidents with injuries",killed:"Number of accidents with fatalities"};_(F,{getMap:()=>a}),_(Q,{getMapbox:()=>l});const m=[[0,"#fcde9c"],[15,"#faa476"],[30,"#f0746e"],[45,"#e34f6f"],[60,"#dc3977"],[75,"#b9257a"],[90,"#7c1d6f"]];function h(e){n(0,u=e),a.setPaintProperty("county_totals","fill-color",{property:u,stops:m})}S((async()=>(l=window.mapboxgl,l.accessToken="pk.eyJ1Ijoic2xkYXRhdGVhbSIsImEiOiJja240emRudmgxdzl4MnVuenp0azNmenE4In0.b5791YyrQaKdVufRXj2lqQ",n(2,a=new l.Map({container:s,style:"mapbox://styles/mapbox/light-v10",center:r.lngLat,zoom:r.zoom,minZoom:7,maxZoom:14})),a.on("load",(()=>{a.resize(),a.addSource("county_totals",{type:"vector",tiles:["https://njam-tiles.s3.amazonaws.com/railroad-crossing-incident-totals/counties/{z}/{x}/{y}.pbf"]}),a.addLayer({id:"county_totals",type:"fill",source:"county_totals","source-layer":"county_totals",layout:{},paint:{"fill-color":{property:u,stops:[[0,"#fcde9c"],[15,"#faa476"],[30,"#f0746e"],[45,"#e34f6f"],[60,"#dc3977"],[75,"#b9257a"],[90,"#7c1d6f"]]},"fill-opacity":["case",["boolean",["feature-state","hover"],!1],1,.8]}}),a.addLayer({id:"county_totals_lines",type:"line",source:"county_totals","source-layer":"county_totals",layout:{},paint:{"line-color":"#444","line-width":2}})})),a.on("mousemove","county_totals",(function(e){a.getCanvas().style.cursor="pointer"})),a.on("mouseleave","county_totals",(function(){a.getCanvas().style.cursor=""})),a.on("click",(async function(e){const t=a.queryRenderedFeatures(e.point);n(3,d=t.find((e=>"county_totals"===e.layer.id)))})),()=>{n(2,a=null)})));return e.$$set=e=>{"$$scope"in e&&n(7,i=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&n(4,o=f[u])},[u,s,a,d,o,m,h,i,c,()=>{h("accidents")},()=>{h("killed")},()=>{h("injured")},function(e){A[e?"unshift":"push"]((()=>{s=e,n(1,s)}))}]}class mt extends n{constructor(e){super(),o(this,e,ft,dt,r,{})}}function ht(e){let t,n,o,r;return o=new mt({}),{c(){t=m("div"),n=m("div"),k(o.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);n=a(r,"DIV",{class:!0});var s=l(n);N(o.$$.fragment,s),s.forEach(c),r.forEach(c),this.h()},h(){i(n,"class","bg-white border h-full border-gray-200 rounded-md shadow"),i(t,"class","p-4 h-full bg-gray-50")},m(e,s){u(e,t,s),d(t,n),I(o,n,null),r=!0},p:f,i(e){r||($(o.$$.fragment,e),r=!0)},o(e){E(o.$$.fragment,e),r=!1},d(e){e&&c(t),j(o)}}}function pt(e){let t,n,o,r;return o=new ct({}),{c(){t=m("div"),n=m("div"),k(o.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);n=a(r,"DIV",{class:!0});var s=l(n);N(o.$$.fragment,s),s.forEach(c),r.forEach(c),this.h()},h(){i(n,"class","bg-white border h-full border-gray-200 rounded-md shadow"),i(t,"class","p-4 h-full bg-gray-50")},m(e,s){u(e,t,s),d(t,n),I(o,n,null),r=!0},p:f,i(e){r||($(o.$$.fragment,e),r=!0)},o(e){E(o.$$.fragment,e),r=!1},d(e){e&&c(t),j(o)}}}function gt(e){let t,n,o,r;return o=new Fe({props:{rows:e[0],columns:e[1],next:e[2],rowsCount:e[3],loaded:e[5],currentPage:e[6]}}),o.$on("query",e[9]),o.$on("nextPage",e[10]),o.$on("previousPage",e[11]),o.$on("viewLocation",e[12]),{c(){t=m("div"),n=m("div"),k(o.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);n=a(r,"DIV",{class:!0});var s=l(n);N(o.$$.fragment,s),s.forEach(c),r.forEach(c),this.h()},h(){i(n,"class","bg-white border h-full border-gray-200 rounded-md shadow"),i(t,"class","p-4 pb-12 h-full bg-gray-50")},m(e,s){u(e,t,s),d(t,n),I(o,n,null),r=!0},p(e,t){const n={};1&t&&(n.rows=e[0]),2&t&&(n.columns=e[1]),4&t&&(n.next=e[2]),8&t&&(n.rowsCount=e[3]),32&t&&(n.loaded=e[5]),64&t&&(n.currentPage=e[6]),o.$set(n)},i(e){r||($(o.$$.fragment,e),r=!0)},o(e){E(o.$$.fragment,e),r=!1},d(e){e&&c(t),j(o)}}}function xt(e){let t,n,o,r;return o=new $e({props:{center:e[7]}}),{c(){t=m("div"),n=m("div"),k(o.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var r=l(t);n=a(r,"DIV",{class:!0});var s=l(n);N(o.$$.fragment,s),s.forEach(c),r.forEach(c),this.h()},h(){i(n,"class","bg-white border h-full border-gray-200 rounded-md shadow"),i(t,"class","p-4 h-full bg-gray-50")},m(e,s){u(e,t,s),d(t,n),I(o,n,null),r=!0},p(e,t){const n={};128&t&&(n.center=e[7]),o.$set(n)},i(e){r||($(o.$$.fragment,e),r=!0)},o(e){E(o.$$.fragment,e),r=!1},d(e){e&&c(t),j(o)}}}function yt(e){let t,n,o,r,s,f,g,b,v,w,k,N,I,j,T,_,S,V,A,P,z,L,O,K,q,U,H,Y,G,J,F,Q,W,X,Z,ee,te,ne,oe,re,se,ae,le,ce,ie,ue,de,fe,me,he,pe,ge,xe,ye,be,ve,we,$e,Ee,ke,Ne,Ie,Ce,De,je,Te;const _e=[xt,gt,pt,ht],Se=[];function Ve(e,t){return"map"===e[4]?0:"list"===e[4]?1:"us-totals"===e[4]?2:"nj-totals"===e[4]?3:-1}return~(fe=Ve(e))&&(me=Se[fe]=_e[fe](e)),{c(){t=m("script"),o=m("link"),r=m("script"),f=m("link"),g=x(),b=m("div"),v=m("div"),w=m("h1"),k=h("Railroad Crossing Incidents"),N=x(),I=m("div"),j=m("nav"),T=m("button"),_=m("span"),S=h("Map"),V=x(),A=m("span"),L=x(),O=m("button"),K=m("span"),q=h("Locations"),U=x(),H=m("span"),J=x(),F=m("button"),Q=m("span"),W=h("N.J. Totals"),X=x(),Z=m("span"),ne=x(),oe=m("button"),re=m("span"),se=h("U.S. Totals"),ae=x(),le=m("span"),ue=x(),de=m("div"),me&&me.c(),he=x(),pe=m("div"),ge=h("Story by "),xe=m("a"),ye=h("Payton Guion"),be=h(". Graphics by "),ve=m("a"),we=h("Seth Vincent"),$e=h(". "),Ee=m("br"),ke=h("Data from the "),Ne=m("a"),Ie=h("Federal Railroad Administration"),Ce=h("."),this.h()},l(e){const n=B('[data-svelte="svelte-hlw6vs"]',document.head);t=a(n,"SCRIPT",{src:!0}),l(t).forEach(c),o=a(n,"LINK",{href:!0,rel:!0}),r=a(n,"SCRIPT",{src:!0}),l(r).forEach(c),f=a(n,"LINK",{rel:!0,href:!0,type:!0}),n.forEach(c),g=y(e),b=a(e,"DIV",{class:!0});var s=l(b);v=a(s,"DIV",{class:!0});var i=l(v);w=a(i,"H1",{class:!0});var u=l(w);k=p(u,"Railroad Crossing Incidents"),u.forEach(c),i.forEach(c),N=y(s),I=a(s,"DIV",{class:!0});var d=l(I);j=a(d,"NAV",{class:!0,"aria-label":!0});var m=l(j);T=a(m,"BUTTON",{class:!0,"aria-current":!0});var h=l(T);_=a(h,"SPAN",{});var x=l(_);S=p(x,"Map"),x.forEach(c),V=y(h),A=a(h,"SPAN",{"aria-hidden":!0,class:!0}),l(A).forEach(c),h.forEach(c),L=y(m),O=a(m,"BUTTON",{class:!0,"aria-current":!0});var $=l(O);K=a($,"SPAN",{});var E=l(K);q=p(E,"Locations"),E.forEach(c),U=y($),H=a($,"SPAN",{"aria-hidden":!0,class:!0}),l(H).forEach(c),$.forEach(c),J=y(m),F=a(m,"BUTTON",{class:!0,"aria-current":!0});var C=l(F);Q=a(C,"SPAN",{});var D=l(Q);W=p(D,"N.J. Totals"),D.forEach(c),X=y(C),Z=a(C,"SPAN",{"aria-hidden":!0,class:!0}),l(Z).forEach(c),C.forEach(c),ne=y(m),oe=a(m,"BUTTON",{class:!0,"aria-current":!0});var P=l(oe);re=a(P,"SPAN",{});var M=l(re);se=p(M,"U.S. Totals"),M.forEach(c),ae=y(P),le=a(P,"SPAN",{"aria-hidden":!0,class:!0}),l(le).forEach(c),P.forEach(c),m.forEach(c),d.forEach(c),ue=y(s),de=a(s,"DIV",{class:!0});var z=l(de);me&&me.l(z),z.forEach(c),he=y(s),pe=a(s,"DIV",{class:!0});var R=l(pe);ge=p(R,"Story by "),xe=a(R,"A",{href:!0,target:!0,class:!0});var Y=l(xe);ye=p(Y,"Payton Guion"),Y.forEach(c),be=p(R,". Graphics by "),ve=a(R,"A",{href:!0,target:!0,class:!0});var G=l(ve);we=p(G,"Seth Vincent"),G.forEach(c),$e=p(R,". "),Ee=a(R,"BR",{class:!0}),ke=p(R,"Data from the "),Ne=a(R,"A",{href:!0,target:!0,class:!0});var ee=l(Ne);Ie=p(ee,"Federal Railroad Administration"),ee.forEach(c),Ce=p(R,"."),R.forEach(c),s.forEach(c),this.h()},h(){document.title="Railroad Crossing Incidents",t.src!==(n="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js")&&i(t,"src","https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"),i(o,"href","https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css"),i(o,"rel","stylesheet"),r.src!==(s="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js")&&i(r,"src","https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js"),i(f,"rel","stylesheet"),i(f,"href","https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css"),i(f,"type","text/css"),i(w,"class","font-bold text-gray-600"),i(v,"class","flex-none p-4"),i(A,"aria-hidden","true"),i(A,"class",P="\n          "+("map"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n          absolute inset-x-0 bottom-0 h-0.5\n        "),i(T,"class",z="\n        "+("map"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n        group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n      "),i(T,"aria-current","page"),i(H,"aria-hidden","true"),i(H,"class",Y="\n          "+("list"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n          absolute inset-x-0 bottom-0 h-0.5\n        "),i(O,"class",G="\n        "+("list"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n        group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n      "),i(O,"aria-current","page"),i(Z,"aria-hidden","true"),i(Z,"class",ee="\n            "+("nj-totals"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n            absolute inset-x-0 bottom-0 h-0.5\n          "),i(F,"class",te="\n          "+("nj-totals"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n          group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n        "),i(F,"aria-current","page"),i(le,"aria-hidden","true"),i(le,"class",ce="\n            "+("us-totals"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n            absolute inset-x-0 bottom-0 h-0.5\n          "),i(oe,"class",ie="\n          "+("us-totals"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n          group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n        "),i(oe,"aria-current","page"),i(j,"class","relative z-0 shadow flex divide-x divide-gray-200 border-t border-gray-100 border-"),i(j,"aria-label","Tabs"),i(I,"class","flex-none block"),i(de,"class","flex-grow border-t border-gray-200 overflow-hidden"),i(xe,"href","https://twitter.com/PaytonGuion"),i(xe,"target","_blank"),i(xe,"class","underline"),i(ve,"href","https://twitter.com/sethdvincent"),i(ve,"target","_blank"),i(ve,"class","underline"),i(Ee,"class","sm:hidden"),i(Ne,"href","https://railroads.dot.gov"),i(Ne,"target","_blank"),i(Ne,"class","underline"),i(pe,"class","flex-none p-4 text-xs text-gray-500 border-t border-gray-200"),i(b,"class","flex flex-col h-screen border border-gray-100  max-w-screen-lg mx-auto")},m(n,s){d(document.head,t),d(document.head,o),d(document.head,r),d(document.head,f),u(n,g,s),u(n,b,s),d(b,v),d(v,w),d(w,k),d(b,N),d(b,I),d(I,j),d(j,T),d(T,_),d(_,S),d(T,V),d(T,A),d(j,L),d(j,O),d(O,K),d(K,q),d(O,U),d(O,H),d(j,J),d(j,F),d(F,Q),d(Q,W),d(F,X),d(F,Z),d(j,ne),d(j,oe),d(oe,re),d(re,se),d(oe,ae),d(oe,le),d(b,ue),d(b,de),~fe&&Se[fe].m(de,null),d(b,he),d(b,pe),d(pe,ge),d(pe,xe),d(xe,ye),d(pe,be),d(pe,ve),d(ve,we),d(pe,$e),d(pe,Ee),d(pe,ke),d(pe,Ne),d(Ne,Ie),d(pe,Ce),De=!0,je||(Te=[M(T,"click",e[16]),M(O,"click",e[17]),M(F,"click",e[18]),M(oe,"click",e[19])],je=!0)},p(e,[t]){(!De||16&t&&P!==(P="\n          "+("map"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n          absolute inset-x-0 bottom-0 h-0.5\n        "))&&i(A,"class",P),(!De||16&t&&z!==(z="\n        "+("map"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n        group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n      "))&&i(T,"class",z),(!De||16&t&&Y!==(Y="\n          "+("list"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n          absolute inset-x-0 bottom-0 h-0.5\n        "))&&i(H,"class",Y),(!De||16&t&&G!==(G="\n        "+("list"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n        group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n      "))&&i(O,"class",G),(!De||16&t&&ee!==(ee="\n            "+("nj-totals"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n            absolute inset-x-0 bottom-0 h-0.5\n          "))&&i(Z,"class",ee),(!De||16&t&&te!==(te="\n          "+("nj-totals"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n          group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n        "))&&i(F,"class",te),(!De||16&t&&ce!==(ce="\n            "+("us-totals"===e[4]?"bg-njam-green":"group-hover:bg-gray-300")+"\n            absolute inset-x-0 bottom-0 h-0.5\n          "))&&i(le,"class",ce),(!De||16&t&&ie!==(ie="\n          "+("us-totals"===e[4]?"text-gray-900":"text-gray-500 hover:text-gray-700")+"\n          group relative min-w-0 flex-1 overflow-hidden bg-white py-4 px-4 text-sm font-medium text-center hover:bg-gray-50 focus:z-10\n        "))&&i(oe,"class",ie);let n=fe;fe=Ve(e),fe===n?~fe&&Se[fe].p(e,t):(me&&(C(),E(Se[n],1,1,(()=>{Se[n]=null})),D()),~fe?(me=Se[fe],me?me.p(e,t):(me=Se[fe]=_e[fe](e),me.c()),$(me,1),me.m(de,null)):me=null)},i(e){De||($(me),De=!0)},o(e){E(me),De=!1},d(e){c(t),c(o),c(r),c(f),e&&c(g),e&&c(b),~fe&&Se[fe].d(),je=!1,R(Te)}}}async function bt({fetch:e,page:t}){const n=await e("https://railroad-crossing-data.vercel.app/railroad_crossing_data/RRData.json?&_sort=StateName"),o=await n.json();if(console.log("json",o),n.ok){const{rows:e,columns:t}=Y(o);console.log("json next",o.next);const n=o.filtered_table_rows_count;let r=null;return r=o.next&&o.next.includes(",")?o.next.split(",")[1]:o.next,console.log("next",r),{props:{rows:e,columns:t,next:r,rowsCount:n}}}return{status:n.status,error:new Error("Could not load data")}}function vt(e,t,n){let o,r,s,a;T(e,G,(e=>n(13,a=e)));let{rows:l}=t,{columns:c}=t,{next:i}=t,{rowsCount:u}=t,d=!0,f=1,m=a.query.get("view")||"nj-totals";async function h(e){n(5,d=!1);const{sort:t,filters:o}=e,r=i?`_next=${i}`:"";let s="";t.column&&(s=`_sort${"DESC"===t.order?"_desc":""}=${t.column}`);const a=[];if(o.length)for(const n of o)"StateName"===n.column?a.push(`StateName__exact=${n.value}`):"CountyName"===n.column?a.push(`CountyName__like=${n.value}`):"CityName"===n.column&&a.push(`CityName__like=${n.value}`);const f=`https://railroad-crossing-data.vercel.app/railroad_crossing_data/RRData.json?${[r,...a,s].join("&")}`;console.log("url",f);const m=await fetch(f),h=await m.json();console.log("json",h);const p=Y(h);n(0,l=[...p.rows]),n(1,c=[...p.columns]),n(3,u=h.filtered_table_rows_count);const g=h.rows[0][0];console.log("firstRowId",g),h.next&&h.next.includes(",")?n(2,i=h.next.split(",")[1]):n(2,i=h.next),n(5,d=!0)}async function p(e){a.query.set("view",e),n(4,m=e);const t=a.query.toString();await J(`${H}?${t}`)}K(1e3),q(150);return e.$$set=e=>{"rows"in e&&n(0,l=e.rows),"columns"in e&&n(1,c=e.columns),"next"in e&&n(2,i=e.next),"rowsCount"in e&&n(3,u=e.rowsCount)},e.$$.update=()=>{if(8192&e.$$.dirty&&n(14,o=a.query.get("lng")),8192&e.$$.dirty&&n(15,r=a.query.get("lat")),49152&e.$$.dirty&&n(7,s=o&r?[o,r]:null),8208&e.$$.dirty&&"map"!==m&&(a.query.has("lng")||a.query.has("lat"))){a.query.delete("lng"),a.query.delete("lat");const e=a.query.toString();J(`${H}?${e}`)}},[l,c,i,u,m,d,f,s,p,async function(e){n(2,i=null),n(6,f=1),await h(e.detail)},async function(e){console.log("next"),n(6,f+=1),await h(e.detail)},async function(e){console.log("previous"),n(2,i-=200),i<0&&(n(2,i=null),n(6,f=1)),n(6,f-=1),await h(e.detail)},function(e){const[t,o]=e.detail;a.query.set("lng",t),a.query.set("lat",o),n(7,s=[t,o]),p("map")},a,o,r,()=>{p("map")},()=>{p("list")},()=>{p("nj-totals")},()=>{p("us-totals")}]}export default class extends n{constructor(e){super(),o(this,e,vt,yt,r,{rows:0,columns:1,next:2,rowsCount:3})}}export{bt as load};
